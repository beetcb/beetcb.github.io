<!DOCTYPE html><html><head>
	    <meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>WSL2ä¸­ä½¿ç”¨proxychains ngä»£ç†åŠ é€Ÿ | Beet's blog, a frontEnd lover's blog site</title>
    <link type="text/css" rel="stylesheet" href="/static/main.css">
		<meta name="description" content=" Beet's blog, share &amp; blogging">
		<meta name="title" content="WSL2ä¸­ä½¿ç”¨proxychains ngä»£ç†åŠ é€Ÿ | Beet's blog, a frontEnd lover's blog site">
		<meta property="og:site_name" content="beet's blog">
		<meta property="og:url" content="https://www.beetcb.com/">
		<meta property="og:type" content="website">
		<meta property="og:title" content="WSL2ä¸­ä½¿ç”¨proxychains ngä»£ç†åŠ é€Ÿ | Beet's blog, a frontEnd lover's blog site">
		<meta property="og:description" content=" Beet's blog, share &amp; blogging">
	    <link rel="icon" href="/static/assets/favicon.ico">
	    
	    
      <script src="/static/main.js" defer=""></script>
      <script src="https://cdn.jsdelivr.net/npm/turbolinks@5.2.0/dist/turbolinks.min.js"></script>
	  </head><body>
	    <main class="main">
		
	<article class="article">
	    <h1 class="title">WSL2ä¸­ä½¿ç”¨proxychains ngä»£ç†åŠ é€Ÿ</h1>
	    <div class="location content">
		<a href="/">Home</a> /posts/13/<br>
		<time datetime="Posted date: 2020 Jul 21">Posted date: 2020 Jul 21</time>
	    </div>
	    <div class="content">
		<blockquote>
<p>æƒ…æ™¯ï¼šwindows å·²å¼€å¯ä»£ç†ï¼Œéœ€è¦ WSL2 èµ°ä¸»æœºçš„ä»£ç†</p>
</blockquote>
<p>ä¾ä»¥å‰çš„åšæ³•ï¼Œç›´æ¥ä½¿ç”¨ <code>export http_proxy="http://127.0.0.1:7899"</code>å°±å¯ä»¥ä¸´æ—¶ä½¿ç”¨ï¼Œä½†æ˜¯ WSL2 ä¸‹è®¿é—®ä¸»æœºå·²ç»æ²¡æœ‰è¿™ä¹ˆç®€å•, å®˜æ–¹æ–‡æ¡£æœ‰è¯´æ˜ï¼š</p>
<blockquote>
<p>If you want to access a networking app running on Windows (for example an app running on a NodeJS or SQL server) from your Linux distribution (ie Ubuntu), then you need to use the IP address of your host machine. While this is not a common scenario, you can follow these steps to make it work. - Obtain the IP address of your host machine by running this command from your Linux distribution: cat /etc/resolv.conf - Copy the IP address following the term: nameserver. - Connect to any Windows server using the copied IP address.</p>
</blockquote>
<p>æ‰€ä»¥ï¼Œä¾æ®æ–‡æ¡£ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>/etc/resolv.conf</code> æ–‡ä»¶ä¸­çš„ <code>nameserver</code> å€¼ä½œä¸º hostIPï¼Œè€Œä¸”è¿™ä¸ª hostIP æ˜¯åŠ¨æ€çš„ï¼Œéœ€è¦ä½¿ç”¨è„šæœ¬åŠ¨æ€è·å–ï¼Œä¸‹é¢æ˜¯åˆæ­¥çš„å°è¯•:</p>
<h4>åˆæ­¥æ–¹æ³•(<code>http_proxy</code>)</h4>
<p>æ€è·¯ï¼šä½¿ç”¨ gerp é…åˆæ­£åˆ™åŒ¹é… IP åœ°å€ï¼ŒåŠ¨æ€å†™å…¥   http_proxy; è‡³äºç«¯å£ï¼Œå¦‚æœä¸æƒ³è®¾å®šå›ºå®šå€¼ï¼Œéœ€è¦ç”¨ powershell è·å–ç³»ç»Ÿä»£ç†çš„ç«¯å£å€¼</p>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># è·å¾— hostIP</span><br><span class="token builtin class-name">export</span> <span class="token assign-left variable">hostIP</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">grep</span> -oP  <span class="token string">"(\d+\.)+(\d+)"</span> /etc/resolv.conf<span class="token variable">`</span></span><br><span class="token comment"># è·å¾—ç«¯å£å· =&gt; è¿™éœ€è¦åå°å¯åŠ¨powershellï¼Œå¦‚æœåœ¨æ„é€Ÿåº¦é—®é¢˜ï¼Œå»ºè®®ç›´æ¥è®¾å®šæˆå®šå€¼ï¼Œä»¥åå°‘æ”¹åŠ¨ç«¯å£å°±è¡Œ</span><br><span class="token builtin class-name">export</span> <span class="token assign-left variable">hostPort</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token punctuation">(</span>powershell.exe Get-ItemProperty -Path <span class="token string">"Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\'Internet Settings'"</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">tail</span> -n <span class="token number">13</span> <span class="token operator">|</span> <span class="token function">grep</span> -oP <span class="token string">'\d{4}'</span><span class="token variable">`</span></span><br><span class="token comment"># è®¾ç½®aliasï¼Œé˜²æ­¢å¯åŠ¨shellé»˜è®¤æŒ‚ä»£ç†</span><br><span class="token builtin class-name">alias</span> <span class="token assign-left variable">setProxy</span><span class="token operator">=</span><span class="token string">'export http_proxy="http://<span class="token variable">$hostIP</span>:<span class="token variable">$hostPort</span>"'</span></code></pre>
<p>ä»¥ä¸Šè®¾ç½®å¯ä»¥å†™å…¥ <code>~/bashrc</code>(æˆ– <code>~/.zshrc</code>), ä»¥ååœ¨æƒ³è¦ä½¿ç”¨ä»£ç†çš„æ—¶å€™è¾“å…¥ <code>setProxy</code> å³å¯å¯ç”¨ä»£ç†</p>
<h4>æ”¹è¿›æ–¹æ³•(<code>proxychains ng</code>)</h4>
<p>ä½¿ç”¨ <code>proxychains ng (åˆå proxychains4 )</code> å¯ä»¥æœ‰æ›´ä½³çš„ä»£ç†ä½“éªŒï¼Œç›¸æ¯”äº <code>http_proxy</code>, <code>proxychains ng</code>å¯ä»¥ç»™ç‰¹å®šçš„ç¨‹åºè®¾å®šä»£ç†</p>
<ul>
<li>æ¯”å¦‚ git å°±ä¸éœ€è¦é¢å¤–è®¾å®š <code>git proxy</code> äº†ï¼›</li>
<li>è¿˜æœ‰ vim æ’ä»¶å®‰è£…ç¨‹åºï¼Œåªéœ€è¦å®‰è£…æ—¶ä½¿ç”¨<code>proxychains ng</code>, å°±å…¨éƒ¨ä½¿ç”¨ä»£ç†è¿›è¡Œå®‰è£…ï¼Œè¿™æ˜¯æå…¶æ–¹ä¾¿çš„ï¼›</li>
<li>å¦å¤–ï¼Œ<code>proxychains ng</code> ä¸ä¼šå ç”¨å…¨å±€ä»£ç†ï¼Œåªè¦åŠ ä¸Šä¸€ä¸ªå‰ç¼€å°±å¯ä»¥ä½¿ç”¨ä»£ç†ï¼Œä¸åŠ å‰ç¼€ä¸ä¸ä¼šèµ°ä»£ç†ã€‚</li>
</ul>
<p>æŸ¥çœ‹<a href="https://github.com/rofl0r/proxychains-ng">å®˜æ–¹repo</a>è¿›è¡Œå®‰è£…</p>
<p>å®‰è£…å®Œæˆåéœ€è¦æ›´æ”¹é…ç½®æ–‡ä»¶ï¼ŒåŠ å…¥ä»£ç†ï¼ŒåŒæ ·ç”±äº hostIP æ˜¯åŠ¨æ€çš„ï¼Œè¿™é‡Œéœ€è¦ç”¨è„šæœ¬æ›²çº¿æ›´æ”¹æ­¤æ–‡ä»¶, ä¸‹é¢æ˜¯è¯¦ç»†æ­¥éª¤</p>
<p>1.<code>proxychains4 -h</code> å¯ä»¥æŸ¥çœ‹é…ç½®æ–‡ä»¶ä½ç½®, ä½äº<code>/etc/proxychains4.conf</code></p>
<p>2.<code>cat -n /etc/proxychains4.conf</code>
è®¾ç½®ä»£ç†çš„é‚£ä¸€è¡Œçš„ä½ç½®ï¼Œå°±åœ¨è¿™å‡ è¡Œæ³¨é‡Šçš„ä¸‹é¢ <code># add proxy here # meanwile # defaults set to "tor"</code>, å¯ä»¥çœ‹åˆ°æ˜¯115è¡Œ</p>
<p>æ‰€ä»¥åœ¨è„šæœ¬é‡Œé¢å†™ä¸Šï¼š</p>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># è·å¾—hostIP</span><br><span class="token builtin class-name">export</span> <span class="token assign-left variable">hostIP</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">grep</span> -oP  <span class="token string">"(\d+\.)+(\d+)"</span> /etc/resolv.conf<span class="token variable">`</span></span><br><span class="token comment"># è·å¾—ç«¯å£å·=&gt;è¿™éœ€è¦åå°å¯åŠ¨powershellï¼Œå¦‚æœåœ¨æ„é€Ÿåº¦é—®é¢˜ï¼Œå»ºè®®ç›´æ¥è®¾å®šæˆå®šå€¼ï¼Œä»¥åå°‘æ”¹åŠ¨ç«¯å£å°±è¡Œ</span><br><span class="token builtin class-name">export</span> <span class="token assign-left variable">hostPort</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token punctuation">(</span>powershell.exe Get-ItemProperty -Path <span class="token string">"Registry::HKCU\Software\Microsoft\Windows\CurrentVersion\'Internet Settings'"</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token function">tail</span> -n <span class="token number">13</span> <span class="token operator">|</span> <span class="token function">grep</span> -oP <span class="token string">'\d{4}'</span><span class="token variable">`</span></span><br><span class="token comment"># æ›¿æ¢é…ç½®æ–‡ä»¶é‡Œè®¾ç½®ä»£ç†é‚£ä¸€è¡Œ</span><br><span class="token function">sudo</span> <span class="token function">sed</span> -i <span class="token string">"115c http <span class="token variable">$hostIP</span> <span class="token variable">$hostPort</span>"</span> /etc/proxychains4.conf</code></pre>
<h4>ç®€åŒ–æ“ä½œ</h4>
<p>ç»™ <code>proxychains4</code> å‘½ä»¤è®¾å®š alias</p>
<pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">alias</span> <span class="token assign-left variable">px</span><span class="token operator">=</span><span class="token string">'proxychains4'</span><br><span class="token comment"># æ­¤ååªéœ€è¾“å…¥ px git pull å³å¯</span></code></pre>
<blockquote>
<p>æ³¨æ„ï¼š<code>px gp</code> å¦‚æ­¤çš„è¿ç»­ä¸¤ä¸ªaliasæ˜¯æ— æ³•è¯†åˆ«çš„ï¼Œä¾æ—§éœ€è¦ä½¿ç”¨<code>px git pull</code></p>
</blockquote>
<p>æœ€åï¼Œæ”¾ä¸€å¼  <code>proxychains ng</code> ä½“éªŒå›¾
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAMCAIAAAAYkIEcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAChUlEQVQozz3S2W6bQBQGYJ6mV22lpIkUO/GCDTiJ0ihqlZs2a+3IsYNtVmObZWAWNgPOI/eMiSL9QgMSH2f+QVDmgawzUc9FY9vV85657Ro5LLpaLmpbSS8kvZSNsrfYKovil1E9We9DrbqfprdDdv3Izv+ywR96eYevHyNBMWLFyiWr7NWW8WG1F1l7nnXmeXuWtdWsMUna0+Rmkb04hbbKZxZ71choRh+m7H5Cn97waBYJfauU7Uq2udXR8g4oWtZapE01brzFTZ6kMYmPXmhzTG+0WN2kHooDRP2AugFz3NheU2dDNh4R5GU5cCplWYq1pfGhOlp2Nk8bH1xyMmEHQ3w8wj9nZLpibkCCAAcIo5AGiPkBgSBEBcWpauuzKUAhfEw92+vZqZocjsCKrmrLJ56PPc5RH1FvfxsEewsg2CN/3+RK3ywgvEGTPwELpvv+Lzx4Rpdv0atDwfLB8jFsE+LxW8KtwWpXjybZZY3CQuZr+EY1WFbAtebp0Zgcv0RXKh4voRrsuqHrRp9csI8gO1V/WUjLsm8X0J1kFz2TRzT4tW8Vn6O1puy3zmabGCEWhjQMWRTFEFjAk31fq53kVCACB1HsQjG3F9b23MjPTZ6BkSt61lPZhUqfDLpxWRrFCY4JSTBOwEIhg+KCgAiD9buy3smrCsQeQLBNM7+0C1AuOJRJWirO4tNx1B+Hd4tovaHcIglYEa6H4hDsV5CgEfgh7KJjbdtGLpq5qGcyEHoKSm+etKbkZBwdPnunQ/9WRZaDKaIE3kfwK0BfvHW/trpW0YZ2jbyppU04fi1rLtL6eqZlJ2r845V8HaIvD963Z38wDccOcfnZ1fWH9Qlyy8P/ARIxiWH5SBO4AAAAAElFTkSuQmCC" alt="px test" data-src="https://m.beetcb.com/postimg/13/13.png" class="lazyload" width="1987" height="927"></p>
<p>å‚è€ƒåŠè¡¥å……ï¼š</p>
<ul>
<li><a href="https://www.hi-linux.com/posts/48321.html">é€šè¿‡ ProxyChains-NG å®ç°ç»ˆç«¯ä¸‹ä»»æ„åº”ç”¨ä»£ç†</a></li>
<li><a href="https://docs.microsoft.com/en-us/windows/wsl/compare-versions#accessing-windows-networking-apps-from-linux-host-ip">Accessing Windows networking apps from Linux (host IP)</a></li>
</ul>

	    </div>
		<div class="outline"></div>
		<div class="comment">
			<button id="show-comments" onclick="loadDisqus();return false;">Load/Post Comments ğŸ¤—</button>
			<div id="disqus_thread"></div>
		</div>
	</article>

	<script>
	var disqus_config = function () {
		this.page.url = "https://www.beetcb.com/posts/13/"
		this.page.identifier = "/posts/13/"
	};
	function loadDisqus() {
    var d = document,
      s = d.createElement('script'),
      load = document.getElementById('show-comments'),
      dot = 0

    // loading animation
    load.innerHTML = 'loading ' + 'â—¦' + ' ğŸ˜›'
    loadInterval = setInterval(() => {
      load.innerHTML = 'loading ' + 'â—¦'.repeat(dot + 2) + ' ğŸ˜›'
      dot === 1 ? (dot = -dot) : dot++
    }, 1000)

    s.async = true
    s.setAttribute('data-timestamp', +new Date())
    s.src = 'https://beets-blog.disqus.com/embed.js'
    ;(d.head || d.body).appendChild(s)

    function listen(target, event, callback) {
      return target.addEventListener(event, callback)
    }

    // check the comment loadding process
    let commentPromise = new Promise((resolve, reject) => {
      listen(s, 'load', resolve)
      listen(s, 'error', reject)
    })
    commentPromise
      .then(() => {
        clearInterval(loadInterval)
        s.removeEventListener('load', arguments.callee)
        load.innerHTML = 'loadding completed ğŸ˜'
        setTimeout(() => (load.style.display = 'none'), 1000)
      })
      .catch(() => {
        clearInterval(loadInterval)
        s.removeEventListener('load', arguments.callee)
        load.innerHTML = 'ğŸ¶ OOPSï¼Try to use Proxy?'
      })
  }	
	</script>
	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>                     
     
		</main>
		<footer class="footer">
		    <div class="footer-desc">
			made with love&amp;<a style="color: skyblue;" href="https://www.11ty.dev/" target="_blank">11ty</a> by beet <br> 
			<a href="http://www.beian.miit.gov.cn/" target="_blank">ICP-20003648-1</a>
		    </div>
		</footer>
	    <script>
            (function (selector, src, preferNativeLazyLoad) {
  var images = document.querySelectorAll(selector);
  var numImages = images.length;

  if (numImages > 0) {
    if (preferNativeLazyLoad && 'loading' in HTMLImageElement.prototype) {
      for (var i = 0; i < numImages; i++) {
        var keys = ['src', 'srcset'];

        for (var j = 0; j < keys.length; j++) {
          if (images[i].hasAttribute('data-' + keys[j])) {
            var value = images[i].getAttribute('data-' + keys[j]);
            images[i].setAttribute(keys[j], value);
          }
        }
      }

      return;
    }

    var script = document.createElement('script');
    script.async = true;
    script.src = src;
    document.body.appendChild(script);
  }
})(
              'img',
              'https://m.beetcb.com/lib/lazysizes.min.js',
              false
            );
          </script></body></html>